<core:FragmentDefinition
    xmlns="sap.m"
    xmlns:core="sap.ui.core"
    xmlns:l="sap.ui.layout"
>
    <VBox>
        <core:Fragment
            fragmentName="cles.agenti.view.fragment.common.FilterBar"
            type="XML"
        />
        <List
          id="proposta_list"
            width="100%"
            mode="None"
            growing="true"
            growingThreshold="20"
            growingScrollToLoad="true"
            sticky="HeaderToolbar,ColumnHeaders,InfoToolbar"
            items="{
              path: 'proposta>/table/items', 
              sorter: {
                path: 'order_id',
                descending: false,
                group: '.getGroup'
              },
              groupHeaderFactory: '.getGroupFactory'
            }"
        >
            <headerToolbar>
                <OverflowToolbar
                    design="Solid"
                    style="Clear"
                >
                    <ToolbarSpacer />
                    <Button
                        text="Ordina"
                        type="Emphasized"
                        icon="sap-icon://sort"
                        press=".onFilterPress"
                    />
                </OverflowToolbar>
            </headerToolbar>
            <infoToolbar>
                <Toolbar
                    design="Solid"
                    style="Clear"
                >
                    <SearchField
                        placeholder="Cerca per categoria o codice/descrizione"
                        showSearchButton="false"
                        liveChange="onSearch($event, 'proposta_prodotti')"
                    />
                </Toolbar>
            </infoToolbar>
            <items>
                <CustomListItem
                    type="Active"
                    press=".onProductListItemPress($event, 'LISTA')"
                >
                    <HBox>
                        <Image
                            src="{proposta>src}"
                            
                            lazyLoading="true"
                            width="6rem"
                            height="6rem"
                            press=".onShowPhotoPress"
                        />
                        <HBox
                            width="100%"
                            wrap="Wrap"
                            class="sapUiSmallMarginBegin"
                            alignContent="Center"
                            alignItems="Center"
                            justifyContent="SpaceBetween"
                        >
                            <VBox class="sapUiTinyMargin">
                                <Label
                                    wrapping="true"
                                    design="Bold"
                                    text="Categoria: {proposta>category}"
                                />
                                <Label
                                    wrapping="true"
                                    design="Bold"
                                    text="Prodotto: {proposta>product}"
                                />
                                <Label
                                    wrapping="true"
                                    design="Bold"
                                    text="Descrizione: {proposta>description}"
                                />
                            </VBox>
                            <VBox class="sapUiTinyMargin">
                                <Label
                                    design="Bold"
                                    text="Ultimo acquisto: {proposta>u_acq}"
                                />
                                <Label
                                    design="Bold"
                                    text="Ultimo prezzo: {proposta>u_prz} €"
                                />
                                <Label
                                    design="Bold"
                                    text="Ultima quantità: {proposta>u_qta}"
                                />
                            </VBox>
                            <VBox class="sapUiTinyMargin">
                                <Label
                                    design="Bold"
                                    text="Disponibilità: {proposta>disponibilita}"
                                />
                                <ProgressIndicator
                                    class="sapUiSmallMarginBottom"
                                    percentValue="50"
                                    showValue="false"
                                    state="Error"
                                />
                                <ObjectStatus
                                    text="{proposta>status_text}"
                                    active="true"
                                    inverted="true"
                                    state="{proposta>status_state}"
                                />
                            </VBox>
                        </HBox>
                    </HBox>
                </CustomListItem>
            </items>
        </List>
    </VBox>
</core:FragmentDefinition>
