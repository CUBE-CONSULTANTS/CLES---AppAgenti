sap.ui.define(["./BaseController","../model/models","../model/formatter","../model/Dialog","sap/m/MessageBox"],(e,t,r,o,s)=>{"use strict";return e.extend("cles.agenti.controller.Main",{formatter:r,onInit(){this.getRouter().getRoute("Main").attachPatternMatched(this._onObjectMatched,this);this.getView().setModel(t.createMainModel(),"main")},_onObjectMatched(e){const{arguments:t}=e.getParameters();this.getModel("layout").setProperty("/layoutMode","OneColumn");if(t["?query"]){const{customer:e,customer_name:r}=t["?query"];this.getModel("main").setProperty("/header/customer/id",e);this.getModel("main").setProperty("/header/customer/name",r)}},onHeaderAttachmentPress(){o.getAttachmentDialog({controller:this})},onHeaderAttachmentItemPress(e){const t=new sap.m.PDFViewer({title:"Allegato",isTrustedSource:true});this.getView().addDependent(t);t.setSource(sap.ui.require.toUrl("https://sapui5.hana.ondemand.com/sap/m/sample/PDFViewerPopup/sample1.pdf"));t.open()},onCustomerValueHelpRequest(){o.getCustomerValueHelp({controller:this})},onCustomerValueHelpConfirm(e){const t=e.getSource().getParent();t.close()},onCustomerListSelect(e){const t=e.getSource().getParent().getParent().getParent().getParent().getParent();const r=e.getSource();if(!r)return;const o=r.getBindingContext();this.getModel("main").setProperty("/header/customer/id",o.getProperty("id"));this.getModel("main").setProperty("/header/customer/name",o.getProperty("name"));t.getModel().setProperty("/iconTabBar/selectedKey","FORM")},onPreorderValueHelpRequest(){o.getPreorderValueHelp({controller:this})},onPreorderValueHelpConfirm(e){const t=e.getSource().getParent().getParent();const r=e.getSource();if(!r)return;const o=r.getBindingContext();this.getModel("main").setProperty("/header/preorder/id",o.getProperty("id"));this.getModel("main").setProperty("/header/preorder/name",o.getProperty("name"));t.close()},onCreaDocumentoPress(e){const{header:{mode:t,customer:r,date:o,title:a,notes:n,attachments:{items:i}}}=this.getModel("main").getData();let l,d=false;switch(t?.selectedKey){case"ORD":if(r.name&&r.id)d=true;l={mode:t.selectedKey,customer:r,notes:n};break;case"OFF":if(r.name&&r.id&&o.value)d=true;l={mode:t.selectedKey,customer:r,date:o,notes:n};break;case"PRE":if(a.value)d=true;l={mode:t.selectedKey,title:a,notes:n};break;default:break}if(!d)return s.error("Compilare i campi obbligatori");this.getModel("proposta").setProperty("/header",{...l,attachments:i});this.getRouter().navTo("Ordine")},onShowFormPress(e){const t=e.getSource();const r=t.getParent();r.getModel().setProperty("/formVisible",!r.getModel().getProperty("/formVisible"))}})});
//# sourceMappingURL=Main.controller.js.map