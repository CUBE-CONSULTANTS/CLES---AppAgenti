<core:FragmentDefinition
    xmlns="sap.m"
    xmlns:core="sap.ui.core"
    xmlns:l="sap.ui.layout"
>
    <VBox>
        <core:Fragment
            fragmentName="cles.agenti.view.fragment.common.FilterBar"
            type="XML"
        />
        <ScrollContainer
            height="400px"
            vertical="true"
        >
            <List
                id="storico_list"
                width="100%"
                mode="None"
                growing="true"
                growingThreshold="20"
                growingScrollToLoad="true"
                sticky="HeaderToolbar,ColumnHeaders,InfoToolbar"
                items="{
                  path: 'proposta>/table/items', 
                  sorter: {
                    path: 'category',
                    descending: false,
                    group: '.getGroup'
                  },
                  groupHeaderFactory: '.getGroupFactory'
                }"
            >
                <headerToolbar>
                    <core:Fragment
                        fragmentName="cles.agenti.view.fragment.common.HeaderToolbar"
                        type="XML"
                    />
                </headerToolbar>
                <items>
                    <CustomListItem
                        type="Active"
                        press=".onProductListItemPress($event, 'LISTA')"
                    >
                        <HBox>
                            <Image
                                class="circularImage"
                                src="{proposta>src}"
                                lazyLoading="true"
                                width="6rem"
                                height="6rem"
                                press=".onShowPhotoPress"
                            />
                            <HBox
                                width="100%"
                                wrap="Wrap"
                                class="sapUiSmallMarginBegin"
                                alignContent="Center"
                                alignItems="Center"
                                justifyContent="SpaceBetween"
                            >
                                <VBox class="sapUiTinyMargin">
                                    <ObjectStatus
                                        inverted="true"
                                        state="Indication12"
                                        text="{proposta>category}"
                                    />
                                    <Label
                                        wrapping="true"
                                        design="Bold"
                                        text="{proposta>description} ({proposta>product})"
                                    />
                                </VBox>
                                <VBox class="sapUiTinyMargin">
                                    <Label
                                        design="Bold"
                                        text="Ultimo acquisto: {proposta>u_acq}"
                                    />
                                    <Label
                                        design="Bold"
                                        text="Ultimo prezzo: {proposta>u_prz} €"
                                    />
                                    <Label
                                        design="Bold"
                                        text="Ultima quantità: {proposta>u_qta}"
                                    />
                                </VBox>
                                <VBox class="sapUiTinyMargin">
                                    <Label
                                        design="Bold"
                                        text="Disponibilità: {proposta>disponibilita}"
                                    />
                                    <ProgressIndicator
                                        class="sapUiSmallMarginBottom"
                                        percentValue="50"
                                        showValue="false"
                                        state="Error"
                                    />
                                    <ObjectStatus
                                        text="{proposta>status_text}"
                                        active="true"
                                        inverted="true"
                                        state="{proposta>status_state}"
                                    />
                                </VBox>
                                <VBox>
                                    <StepInput
                                        change=".onStepInputChange"
                                        min="0"
                                    />
                                </VBox>
                            </HBox>
                        </HBox>
                    </CustomListItem>
                </items>
            </List>
        </ScrollContainer>
    </VBox>
</core:FragmentDefinition>
